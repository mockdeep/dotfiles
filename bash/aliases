# work with dotfiles
alias ea='vim ${DOT_PATH}/bash/aliases && rl'
alias rl="source ${DOT_PATH}/bashrc"

# productivity stuff
alias jnl='vim ${DOC_PATH}/journal/`date +%Y-%m-%d`.txt'
alias outlines='cd ${DOC_PATH}/outlines'
alias lst='outlines && vi list.md && hamdown -f list.md -p 55 -tc > list.html && firefox list.html'

# system stuff
alias ud="sudo apt-get update && sudo apt-get upgrade"
alias grep='grep --color=auto'
alias fgrep='fgrep --color=auto'
alias egrep='egrep --color=auto'

# project paths
alias kp='cd ${BIN_PATH}/kp'
alias hdown='cd ${BIN_PATH}/hamdown'
alias bin='cd ${BIN_PATH}'
alias web='cd ${BIN_PATH}/class/website'

# ruby/rails stuff
alias spec="spec --color --format nested"
alias gems='cd /usr/lib/ruby/gems/1.8/gems'
alias sc='script/console'
alias ss='script/server'
alias sdbc='script/dbconsole'
alias rc="rails console"
alias rs="rails server"
alias remigrate='rake db:migrate VERSION=0 && rake db:migrate'
alias gb='gem build *.gemspec && gem push *.gem && rm *.gem'
# echo is to trim leading spaces
alias killr='ps | grep ruby | xargs echo | cut -f 1 -d " " | xargs kill -9'
alias killrb='ps | grep irb | xargs echo | cut -f 1 -d " " | xargs kill -9'
alias testit='ruby -Ilib:test'

function blamer {
    git ls-tree -r HEAD | sed -re 's/^.{53}//' | while read filename; do file "$filename"; done | grep -E ': .*text'|sed -r -e 's/: .*//' | while read filename; do git blame "$filename"; done | cut -f 2 -d '(' | cut -f 1 -d ' ' | sort | uniq -i -c | sort -h -r
}

function jl {
    cp -n ~/Templates/Document.odt ${DOC_PATH}/journal/`date +%Y-%m-%d`.odt
    openit ${DOC_PATH}/journal/`date +%Y-%m-%d`.odt
}

# open a file, choosing utility based on Mac/Linux
function openit {
    unamestr=`uname`
    if [[ $unamestr == 'Darwin' ]]; then
        open $1
    else
        xdg-open $1
    fi
}

function list {
    openit ${DOC_PATH}/lists/list.odt
}

# search all files in this folder recursively for some text
function grepit {
    grep -nr "$1" ./*
}

# search rails app in lib and app folders for text
function grepap {
    grep -nr "$1" lib/*
    grep -nr "$1" app/*
}

if [[ `uname` == 'Darwin' ]]; then
  alias ls='ls -G'
else
  alias ls='ls --color'
fi
