# work with dotfiles
alias ea='vim ${DOT_PATH}/bash/aliases && rl'
alias rl="source ${DOT_PATH}/bashrc"

alias la='ls -a'
alias emacs='emacs -nw'
alias git=hub
alias hrc='heroku run console -r heroku'
alias hrcs='heroku run console -r staging'

# productivity stuff
alias jnl='vim ${DOC_PATH}/journal/`date +%Y-%m-%d`.txt'

function jrnl {
  today=`date +%Y-%m-%d`
  filepath="${DOC_PATH}/journal"
  i=0
  while [ -e "${filepath}/${today}.${i}.txt" ]; do
    let i=i+1
  done
  vim "${filepath}/${today}.${i}.txt"
}

alias outlines='cd ${DOC_PATH}/outlines'
alias lst='outlines && vi list.md && hamdown -f list.md -p 55 -c -t > list.html && firefox list.html'
alias tasks="trello card list -l $TRELLO_NOW_LIST_ID | grep Name: | cut -f 2 -d ')'"

# system stuff
alias ud="sudo apt-get update && sudo apt-get upgrade && sudo apt-get dist-upgrade"
alias grep='grep --color=auto'
alias fgrep='fgrep --color=auto'
alias egrep='egrep --color=auto'

# project paths
alias bm='cd ${PROJECT_PATH}/web_apps/better'
alias boo='cd ${PROJECT_PATH}/web_apps/boon-blog'
alias bt='cd ${PROJECT_PATH}/web_apps/boon_top'
alias ch='cd ${PROJECT_PATH}/web_apps/chai'
alias hdown='cd ${PROJECT_PATH}/gems/hamdown'
alias spu='cd ${PROJECT_PATH}/gems/speculate'
alias mu='cd ${PROJECT_PATH}/open_source/mutant'
alias gafk='cd ${PROJECT_PATH}/open_source/afk'
alias junk='cd ${PROJECT_PATH}/open_source/junk_drawer'
alias conf='cd ${PROJECT_PATH}/open_source/configurator'
alias rma='cd ${PROJECT_PATH}/open_source/rake-compiler-dev-box/rmagick'
alias news='cd ${PROJECT_PATH}/web_apps/newsie'
alias ti='cd ${PROJECT_PATH}/web_apps/tithe'
alias todo='cd ${PROJECT_PATH}/web_apps/elements'

# ruby/rails stuff
alias spec="spec --color --format nested"
alias fsd="foreman start -f Procfile.dev"
alias sc='script/console'
alias ss='script/server'
alias sdbc='script/dbconsole'
alias rc="rails console"
alias rs="rails server"
alias zs="zeus server"
alias zc="zeus console"
alias remigrate='rake db:migrate VERSION=0 && rake db:migrate'
alias gb='gem build *.gemspec && gem push *.gem && rm *.gem'
alias gems='cd $GEM_HOME/gems'
alias soc='cd ${PROJECT_PATH}/socrates'
alias sql='cd ${PROJECT_PATH}/sql_sampler'
alias rbp='rails_best_practices .'
alias nogems="gem list | cut -f 1 -d ' ' | xargs gem uninstall -a"
alias mutate="be mutant -I lib -d -r ./config/environment.rb -r ./app/models/user.rb --rspec-dm2 ::User"

alias shonk="npm install && npm prune && npm shrinkwrap && shonkwrap"
# echo is to trim leading spaces
alias killr='ps | grep ruby | xargs echo | cut -f 1 -d " " | xargs kill -9'
alias killrb='ps | grep irb | xargs echo | cut -f 1 -d " " | xargs kill -9'
alias testit='ruby -Ilib:test'
alias countrb='for file in $(find . | grep \.rb$); do wc -l "$file"; done | sort -h'
alias ns='notify-send "that thing is done"'
notify_sound="$DOT_PATH/sounds/notify.ogg"
alias nsb='ns; ogg123 -q $notify_sound $notify_sound $notify_sound'

# gitty stuff
alias bomb='ruby ${SCRIPT_PATH}/branch_bomb.rb'
alias gp='git pull'
alias gpu='git pull upstream master'
alias gcm='git checkout master'
alias gcs='git checkout staging'

# $BRANCH_PREFIXES looks like "\s\(rf-\|robert-\)"
alias baes='for i in $(git br | grep -e $BRANCH_PREFIXES); do git co $i; git rebase master || break; done; git co master'
alias gitclean='git remote prune origin && git br --merged | grep -e $BRANCH_PREFIXES | xargs git br -d'
function blamer {
    git ls-tree -r HEAD | sed -re 's/^.{53}//' | while read filename; do file "$filename"; done | grep -E ': .*text'|sed -r -e 's/: .*//' | while read filename; do git blame "$filename"; done | cut -f 2 -d '(' | cut -f 1 -d ' ' | sort | uniq -i -c | sort -h -r
}

function jl {
    cp -n ~/Templates/Document.odt ${DOC_PATH}/journal/`date +%Y-%m-%d`.odt
    openit ${DOC_PATH}/journal/`date +%Y-%m-%d`.odt
}

# open a file, choosing utility based on Mac/Linux
function openit {
    unamestr=`uname`
    if [[ $unamestr == 'Darwin' ]]; then
        open $1
    else
        xdg-open $1
    fi
}
alias o='openit'

function list {
    openit ${DOC_PATH}/lists/list.odt
}

# search all files in this folder recursively for some text
function grepit {
    grep -nr "$1" ./*
}

# search rails app in lib and app folders for text
function grepap {
    grep -nr "$1" lib/*
    grep -nr "$1" app/*
}

if [[ `uname` == 'Darwin' ]]; then
  alias ls='ls -G'
else
  alias ls='ls --color'
fi

# reset touchpad when it stops responding after opening laptop
alias touchy='sudo modprobe -r psmouse && sudo modprobe psmouse'

# remove trailing spaces
alias notrail="find . -regextype posix-egrep -regex '.*\.(erb|rake|rb|js|haml|html|css|scss|java|coffee|yml)$' -type f -exec sed 's/[ \t]*$//' -i {} \;"

# replace tabs with spaces
alias notab="find . -regextype posix-egrep -regex '.*\.(erb|rake|rb|js|haml|html|css|scss|java|coffee|yml)$' -type f -exec sed 's/\t/  /g' -i {} \;"
