# work with dotfiles
alias ea='vim ${DOT_PATH}/bash/aliases && rl'
alias rl="source ${DOT_PATH}/bashrc"

alias la='ls -a'

# productivity stuff
alias jnl='vim ${DOC_PATH}/journal/`date +%Y-%m-%d`.txt'

function jrnl {
  today=`date +%Y-%m-%d`
  filepath="${DOC_PATH}/journal"
  i=0
  while [ -e "${filepath}/${today}.${i}.txt" ]; do
    let i=i+1
  done
  vim "${filepath}/${today}.${i}.txt"
}

alias outlines='cd ${DOC_PATH}/outlines'
alias lst='outlines && vi list.md && hamdown -f list.md -p 55 -c -t > list.html && firefox list.html'

# system stuff
alias ud="sudo apt-get update && sudo apt-get upgrade"
alias grep='grep --color=auto'
alias fgrep='fgrep --color=auto'
alias egrep='egrep --color=auto'

# project paths
alias hdown='cd ${PROJECT_PATH}/hamdown'
alias todo='cd ${PROJECT_PATH}/elements'
alias steam='cd ${PROJECT_PATH}/steamer'

# ruby/rails stuff
alias spec="spec --color --format nested"
alias sc='script/console'
alias ss='script/server'
alias sdbc='script/dbconsole'
alias rc="rails console"
alias rs="rails server"
alias remigrate='rake db:migrate VERSION=0 && rake db:migrate'
alias gb='gem build *.gemspec && gem push *.gem && rm *.gem'
# echo is to trim leading spaces
alias killr='ps | grep ruby | xargs echo | cut -f 1 -d " " | xargs kill -9'
alias killrb='ps | grep irb | xargs echo | cut -f 1 -d " " | xargs kill -9'
alias testit='ruby -Ilib:test'
alias countrb='for file in $(find . | grep \.rb$); do wc -l "$file"; done | sort -h'

alias bomb='ruby ${SCRIPT_PATH}/branch_bomb.rb'
alias gpom='git pull origin master'
function blamer {
    git ls-tree -r HEAD | sed -re 's/^.{53}//' | while read filename; do file "$filename"; done | grep -E ': .*text'|sed -r -e 's/: .*//' | while read filename; do git blame "$filename"; done | cut -f 2 -d '(' | cut -f 1 -d ' ' | sort | uniq -i -c | sort -h -r
}

function jl {
    cp -n ~/Templates/Document.odt ${DOC_PATH}/journal/`date +%Y-%m-%d`.odt
    openit ${DOC_PATH}/journal/`date +%Y-%m-%d`.odt
}

# open a file, choosing utility based on Mac/Linux
function openit {
    unamestr=`uname`
    if [[ $unamestr == 'Darwin' ]]; then
        open $1
    else
        xdg-open $1
    fi
}

function list {
    openit ${DOC_PATH}/lists/list.odt
}

# search all files in this folder recursively for some text
function grepit {
    grep -nr "$1" ./*
}

# search rails app in lib and app folders for text
function grepap {
    grep -nr "$1" lib/*
    grep -nr "$1" app/*
}

if [[ `uname` == 'Darwin' ]]; then
  alias ls='ls -G'
else
  alias ls='ls --color'
fi
